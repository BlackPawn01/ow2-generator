<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>OW2 Stadium - Générateur de stratégie</title>
  <style>
    body {
      background-color: #0b0c10;
      color: #c5c6c7;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    select, input, button {
      margin: 5px;
      padding: 5px;
    }
    .recommandation {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #45a29e;
    }
    img {
      float: right;
      height: 200px;
      width: 100px;
      object-fit: contain;
    }
  </style>
</head>
<body>
  <h1>OW2 Stadium - Générateur de stratégie</h1>

  <label for="roleSelect">Rôle :</label>
  <select id="roleSelect">
    <option value="soutien">Soutien</option>
    <option value="dps" disabled>DPS (à venir)</option>
    <option value="tank" disabled>Tank (à venir)</option>
  </select>

  <label for="heroSelect">Héros :</label>
  <select id="heroSelect">
    <option value="Mercy">Mercy</option>
    <option value="Kiriko">Kiriko</option>
    <option value="Moira">Moira</option>
    <option value="Lucio">Lucio</option>
    <option value="Ana">Ana</option>
    <option value="Juno">Juno</option>
  </select>

  <label for="styleSelect">Style de jeu :</label>
  <select id="styleSelect">
    <option value="heal">Priorité soins</option>
    <option value="damage">Priorité dégâts</option>
  </select>

  <div>
    <h3>Points disponibles par manche :</h3>
    <div id="pointsInputs">
      <label>Manche 1 : <input type="number" id="points1" value="1000" min="0" /></label><br />
      <label>Manche 2 : <input type="number" id="points2" value="2000" min="0" /></label><br />
      <label>Manche 3 : <input type="number" id="points3" value="3000" min="0" /></label><br />
      <label>Manche 4 : <input type="number" id="points4" value="4000" min="0" /></label><br />
      <label>Manche 5 : <input type="number" id="points5" value="5000" min="0" /></label><br />
      <label>Manche 6 : <input type="number" id="points6" value="6000" min="0" /></label><br />
      <label>Manche 7 : <input type="number" id="points7" value="7000" min="0" /></label><br />
    </div>
  </div>

  <button onclick="generateRecommendations()">Générer les recommandations</button>

  <div id="resultat" class="recommandation"></div>
  <img id="heroImage" src="" alt="Héros sélectionné" />

  <script>
    const strategies = {
      Mercy: {
        heal: {
          1: [{ nom: "Soin rapide", cout: 1000, categorie: "Capacité" }],
          2: [{ nom: "Déploiement d’Ange gardien", cout: 4000, categorie: "Mobilité" }],
          3: [{ nom: "Amplification de rayon", cout: 5000, categorie: "Arme" }],
          4: [{ nom: "Auto-régénération améliorée", cout: 6000, categorie: "Survie" }],
          5: [{ nom: "Résurrection rapide", cout: 9000, categorie: "Capacité" }],
          6: [],
          7: []
        },
        damage: {
          1: [{ nom: "Pistolet boosté", cout: 1000, categorie: "Arme" }],
          2: [{ nom: "Déploiement d’Ange gardien", cout: 4000, categorie: "Mobilité" }],
          3: [{ nom: "Cadence accrue", cout: 5000, categorie: "Arme" }],
          4: [{ nom: "Combo tir secondaire", cout: 6000, categorie: "Capacité" }],
          5: [{ nom: "Dernière chance", cout: 9000, categorie: "Survie" }],
          6: [],
          7: []
        }
      }
      // Ajouter d'autres héros ici avec leurs catégories corrigées
    };

    function isValidCost(cout) {
      return (cout <= 1500 || (cout >= 3750 && cout <= 6000) || cout >= 9000);
    }

    function generateRecommendations() {
      const role = document.getElementById("roleSelect").value;
      const hero = document.getElementById("heroSelect").value;
      const style = document.getElementById("styleSelect").value;

      const pointsParManche = [];
      for (let i = 1; i <= 7; i++) {
        pointsParManche.push(parseInt(document.getElementById("points" + i).value) || 0);
      }

      const recommandations = [];
      let pointsRestants = [...pointsParManche];
      let competencesPossedees = [];

      for (let manche = 1; manche <= 7; manche++) {
        const options = strategies[hero]?.[style]?.[manche] || [];
        let achatEffectue = false;

        for (const comp of options) {
          if (!isValidCost(comp.cout)) continue;
          if (pointsRestants[manche - 1] >= comp.cout) {
            // Si déjà 6 compétences, revendre la moins chère
            if (competencesPossedees.length >= 6) {
              const moinsChere = competencesPossedees.reduce((a, b) => a.cout < b.cout ? a : b);
              pointsRestants[manche - 1] += moinsChere.cout;
              competencesPossedees = competencesPossedees.filter(c => c !== moinsChere);
              recommandations.push(`Manche ${manche} : Revente de "${moinsChere.nom}" pour ${moinsChere.cout} pts`);
            }

            pointsRestants[manche - 1] -= comp.cout;
            competencesPossedees.push(comp);
            recommandations.push(`Manche ${manche} : Achat de "${comp.nom}" (${comp.categorie}) pour ${comp.cout} pts`);
            achatEffectue = true;
            break;
          }
        }

        if (!achatEffectue) {
          recommandations.push(`Manche ${manche} : Aucun achat (points insuffisants ou compétences invalides)`);
        }
      }

      document.getElementById("resultat").innerHTML = recommandations.join("<br>");
      document.getElementById("heroImage").src = `images/${hero.toLowerCase()}.png`;
    }
  </script>
</body>
</html>
