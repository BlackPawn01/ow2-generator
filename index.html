<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>OW2 Stadium - G√©n√©rateur de strat√©gie</title>
  <style>
    body {
      background-color: #0b0c10;
      color: #c5c6c7;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    select, input, button {
      margin: 5px;
      padding: 5px;
    }
    .recommandation {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #45a29e;
    }
    .inputs-container {
      display: flex;
      align-items: flex-start;
    }
    .points-section {
      flex: 1;
    }
    #heroImage {
      height: 300px;
      width: auto;
      margin-left: 20px;
      object-fit: contain;
    }
  </style>
</head>
<body>
  <h1>OW2 Stadium - G√©n√©rateur de strat√©gie</h1>

  <label for="roleSelect">R√¥le :</label>
  <select id="roleSelect">
    <option value="soutien">Soutien</option>
    <option value="dps" disabled>DPS (√† venir)</option>
    <option value="tank" disabled>Tank (√† venir)</option>
  </select>

  <label for="heroSelect">H√©ros :</label>
  <select id="heroSelect" onchange="updateHeroImage()">
    <option value="Mercy">Mercy</option>
    <option value="Kiriko">Kiriko</option>
    <option value="Moira">Moira</option>
    <option value="Lucio">Lucio</option>
    <option value="Ana">Ana</option>
    <option value="Juno">Juno</option>
  </select>

  <label for="styleSelect">Style de jeu :</label>
  <select id="styleSelect">
    <option value="heal">Priorit√© soins</option>
    <option value="damage">Priorit√© d√©g√¢ts</option>
  </select>

  <div class="inputs-container">
    <div class="points-section">
      <h3>Points disponibles par manche :</h3>
      <label>Manche 1 : <input type="number" id="points1" value="3500" min="3500" /></label><br />
      <label>Manche 2 : <input type="number" id="points2" value="6000" min="6000" /></label><br />
      <label>Manche 3 : <input type="number" id="points3" value="12000" min="6000" /></label><br />
      <label>Manche 4 : <input type="number" id="points4" value="15000" min="6000" /></label><br />
      <label>Manche 5 : <input type="number" id="points5" value="15000" min="6000" /></label><br />
      <label>Manche 6 : <input type="number" id="points6" value="15000" min="6000" /></label><br />
      <label>Manche 7 : <input type="number" id="points7" value="15000" min="6000" /></label><br />
    </div>
    <img id="heroImage" src="images/mercy.png" alt="Image du h√©ros" />
  </div>

  <button onclick="generateRecommendations()">G√©n√©rer les recommandations</button>
  <div id="resultat" class="recommandation"></div>

  <script>
    const strategies = {
      Mercy: {
        heal: {
          1: [{ nom: "Soin cibl√©", cout: 1500, categorie: "Capacit√©" }, { nom: "√âconomie de soin", cout: 1000, categorie: "Capacit√©" }],
          2: [{ nom: "D√©ploiement d‚ÄôAnge gardien", cout: 4000, categorie: "Mobilit√©" }],
          3: [{ nom: "Amplification de rayon", cout: 5000, categorie: "Arme" }],
          4: [{ nom: "Auto-r√©g√©n√©ration am√©lior√©e", cout: 6000, categorie: "Survie" }],
          5: [{ nom: "R√©surrection rapide", cout: 9000, categorie: "Capacit√©" }],
          6: [{ nom: "R√©cup√©ration ultime", cout: 9000, categorie: "Survie" }],
          7: [{ nom: "Chapelet de soin", cout: 12000, categorie: "Capacit√©" }]
        }
        // damage: {} (sera ajout√© ensuite)
      }
      // Autres h√©ros √† compl√©ter
    };

    function isValidCost(cout) {
      return (cout <= 1500 || (cout >= 3750 && cout <= 6000) || cout >= 9000);
    }

    function updateHeroImage() {
      const hero = document.getElementById("heroSelect").value;
      document.getElementById("heroImage").src = `images/${hero.toLowerCase()}.png`;
    }

    function generateRecommendations() {
      const hero = document.getElementById("heroSelect").value;
      const style = document.getElementById("styleSelect").value;
      const pointsParManche = [];
      for (let i = 1; i <= 7; i++) {
        pointsParManche.push(parseInt(document.getElementById(`points${i}`).value) || 0);
      }

      const recommandations = [];
      let pointsRestants = [...pointsParManche];
      let competencesPossedees = [];

      for (let manche = 1; manche <= 7; manche++) {
        const options = strategies[hero]?.[style]?.[manche] || [];
        let achatEffectue = false;

        for (const comp of options) {
          if (!isValidCost(comp.cout)) continue;
          if (pointsRestants[manche - 1] >= comp.cout) {
            if (competencesPossedees.length >= 6) {
              const moinsChere = competencesPossedees.reduce((a, b) => a.cout < b.cout ? a : b);
              pointsRestants[manche - 1] += moinsChere.cout;
              competencesPossedees = competencesPossedees.filter(c => c !== moinsChere);
              recommandations.push(`Manche ${manche} : üîÑ Revente de "${moinsChere.nom}" (+${moinsChere.cout} pts)`);
            }

            pointsRestants[manche - 1] -= comp.cout;
            competencesPossedees.push(comp);
            recommandations.push(`Manche ${manche} : ‚úÖ Achat de "${comp.nom}" [${comp.categorie}] pour ${comp.cout} pts`);
            achatEffectue = true;
            break;
          }
        }

        if (!achatEffectue) {
          recommandations.push(`Manche ${manche} : ‚ùå Aucun achat possible (budget insuffisant ou comp√©tences invalides)`);
        }
      }

      document.getElementById("resultat").innerHTML = recommandations.join("<br>");
    }

    // Chargement initial
    window.onload = updateHeroImage;
  </script>
</body>
</html>
